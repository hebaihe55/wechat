


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
    <script language="javascript" type="text/javascript">
    ///////////////////////////////////////////////////////屏幕尺寸//////////////////////////////////////////////////
    var phoneWidth = parseInt(window.screen.width);
    var phoneScale = phoneWidth / 640;
    var ua = navigator.userAgent;
    if (/Android (\d+\.\d+)/.test(ua)) {
        var version = parseFloat(RegExp.$1);
        // andriod 2.3
        if (version > 2.3) {
            document.write('<meta name="viewport" content="width=640, minimum-scale = ' + phoneScale + ', maximum-scale = ' + phoneScale + ', target-densitydpi=device-dpi">');
            // andriod 2.3以上
        } else {
            document.write('<meta name="viewport" content="width=640, target-densitydpi=device-dpi">');
        }
        // 其他系统
    } else {
        document.write('<meta name="viewport" content="width=640, user-scalable=no, target-densitydpi=device-dpi">');
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    </script>
    <meta name="viewport" content="width=750, user-scalable=no, target-densitydpi=device-dpi" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no">
    <link href="~/Content/yamaha/css/style.css" rel="stylesheet" type="text/css" />
    <title>刮刮卡</title>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript">
            function loading(canvas, options) {
                this.canvas = canvas;
                if (options) {
                    this.radius = options.radius || 12;
                    this.circleLineWidth = options.circleLineWidth || 4;
                    this.circleColor = options.circleColor || 'lightgray';
                    this.moveArcColor = options.moveArcColor || 'gray';
                } else {
                    this.radius = 12;
                    this.circelLineWidth = 4;
                    this.circleColor = 'lightgray';
                    this.moveArcColor = 'gray';
                }
            }
            loading.prototype = {
                show: function () {
                    var canvas = this.canvas;
                    if (!canvas.getContext) return;
                    if (canvas.__loading) return;
                    canvas.__loading = this;
                    var ctx = canvas.getContext('2d');
                    var radius = this.radius;
                    var me = this;
                    var rotatorAngle = Math.PI * 1.5;
                    var step = Math.PI / 6;
                    canvas.loadingInterval = setInterval(function () {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        var lineWidth = me.circleLineWidth;
                        var center = {
                            x: canvas.width / 2,
                            y: canvas.height / 2
                        };

                        ctx.beginPath();
                        ctx.lineWidth = lineWidth;
                        ctx.strokeStyle = me.circleColor;
                        ctx.arc(center.x, center.y + 20, radius, 0, Math.PI * 2);
                        ctx.closePath();
                        ctx.stroke();
                        //在圆圈上面画小圆
                        ctx.beginPath();
                        ctx.strokeStyle = me.moveArcColor;
                        ctx.arc(center.x, center.y + 20, radius, rotatorAngle, rotatorAngle + Math.PI * .45);
                        ctx.stroke();
                        rotatorAngle += step;

                    },
				100);
                },
                hide: function () {
                    var canvas = this.canvas;
                    canvas.__loading = false;
                    if (canvas.loadingInterval) {
                        window.clearInterval(canvas.loadingInterval);
                    }
                    var ctx = canvas.getContext('2d');
                    if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            };
    </script>
    <style>
        #scratchpad{
            position:absolute;
            width:530px;
            height:230px;
            top:238px;
            left:14%;
            z-index:2
        }
        #prize{
            position:absolute;
            width:530px;
            height:230px;
            top:238px;
            left:14%;
            z-index:1;
            background:white;
            font-size:5.5em;
            text-align:center;
           line-height:230px;
        }
    </style>
</head>
<body data-role="page" class="activity-scratch-card-winning">
    <form method="post" action="index.aspx?uid=83838" id="ctl00">
        <div class="aspNetHidden">
            <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTY0OTQwNTk2OGRkvwKr/h7TB3SvdNn8laGTQ2fiuwr5G9jRPlDIdBmUsJ4=" />
        </div>

        <div class="aspNetHidden">

            <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWBALn8bLIDQK/mcmVDAK5mcmVDALxzZakDUsbf/r3xGx3NwM7c6RjimRJ2yH1g32fCVLrWHu85Df1" />
        </div>
        <input name="wid" type="hidden" id="wid" value="oFHAZtvwFffddWtYknf" />
       
        <script src="~/Content/yamaha/js/wScratchPad.js" type="text/javascript"></script>
        <div class="main">
            <div class="cover">
                <img src="~/Content/yamaha/image/guaguakabg.jpg" style="position:absolute;z-index:0;top:0;left:0;">
                <div id="prize">
                </div>
                <div id="scratchpad">
                </div>
            </div>
            
          <img src="~/Content/yamaha/image/lingjiangbtn.png" class="lingjiangbtn" />
        </div>
        <script src="./js/alert.js" type="text/javascript"></script>
        <script type="text/javascript">
		    window.sncode = "null";
		    window.prize = "谢谢参与";

		    var zjl = false;
		    var num = 0;
		    var goon = true;
		    var wechat = null;
		    $(function () {
		        $("#scratchpad").wScratchPad({
		            width:530,
		            height:230,
		            color: "#a9a9a7",
		            scratchMove: function () {

		                var grade = $("#grade").val();

		                num++;
		                if (num == 2) {
		                    //一等奖机率10% 二等奖20% 三等奖30% 幸运奖40%

		                    if (grade == 1) {
		                        var award = "恭喜中奖";
		                        $("#pid").append( '<option value="请选择">请选择</option>');

		                        $("#pid").append('<option value="防过敏男童背心">防过敏男童背心</option>');

		                        $("#pid").append('<option value="防过敏女童背心">防过敏女童背心</option>');

		                        $("#pid").append('<option value="CK连裤袜">CK连裤袜</option>');


		                        $("#psize").append('<option value="请选择">请选择</option>');

		                        $("#pcolor").append('<option value="请选择">请选择</option>');


		                        zjl = true;
		                    }
		                    else if (grade == 2) {
		                        var award = "二等奖";


		                        zjl = true;
		                    }
		                    else if (grade == 3) {
		                        var award = "三等奖";
		                        zjl = true;
		                    }
		                    else {
		                        var award = "谢谢参与";
		                    }
		                    document.getElementById('prize').innerHTML = award;
		                    $("#theAward").html(award);
		                    wechat = $("#wid").val();

		                }

		                if (zjl && num > 10 && goon) {

		                    //$("#zjl").fadeIn();
		                    goon = false;

		                    $("#zjl").slideToggle(500);
		                    //$("#outercont").slideUp(500)
		                }
		            }
		        });

		        //$("#prize").html("谢谢参与");
		        //loadingObj.hide();
		        //$(".loading-mask").remove();
		    });

		    $("#save-btn").bind("click", function () {

		        var tel = $("#tel").val();
		        var mid = $("#mid").val();
		        var tname = $("#tname").val();
		        var tadd = $("#tadd").val();

		        var p1 = $("#pid").val();

		        var p2 = $("#psize").val();

		        var p3 = $("#pcolor").val();


		        var product = $("#pid").val() + '-' + $("#psize").val() + '-' + $("#pcolor").val()

		        if (tel == '' || tname == '' || tadd == '' || p2 == "请选择" || p3 == "请选择" || p1 == "请选择") {
		            alert("请填写完整信息");
		            return
		        }

		        if (tel.length != 11) {
		            alert("请输入正确手机号！");
		            return

                }




		        $.post('info.aspx', { mid: mid, tel: tel, tname: tname, tadd: tadd, p: product }, function (data, status) {

		            if (data == 1) {
		                alert("信息保存成功！");
		                location.href = "end.aspx";
		            }
		            else {

		                alert("信息保存失败！");
		            }
		        })
		    });


		    function change() {

		        var pid = $("#pid").val();

		        $("#psize").empty();
		        $("#pcolor").empty();

		        if (pid == "防过敏男童背心") {

		            $("#psize").append('<option value="请选择">请选择</option>');
		            $("#psize").append('<option value="110">110</option>');
		            $("#psize").append('<option value="120">120</option>');
		            $("#psize").append('<option value="130">130</option>');
		            $("#psize").append('<option value="140">140</option>');
		            $("#psize").append('<option value="150">150</option>');
		            $("#psize").append('<option value="160">160</option>');

		            $("#pcolor").append('<option value="请选择">请选择</option>');
		            $("#pcolor").append('<option value="白色">白色</option>');

		        }
		        else if (pid == "防过敏女童背心") {

		            $("#psize").append('<option value="请选择">请选择</option>');
		            $("#psize").append('<option value="110">110</option>');
		            $("#psize").append('<option value="120">120</option>');
		            $("#psize").append('<option value="130">130</option>');
		            $("#psize").append('<option value="140">140</option>');
		            $("#psize").append('<option value="150">150</option>');
		            $("#psize").append('<option value="160">160</option>');

		            $("#pcolor").append('<option value="请选择">请选择</option>');
		            $("#pcolor").append('<option value="白色">白色</option>');
		        }

		        else {

		            $("#psize").append('<option value="请选择">请选择</option>');
		            $("#psize").append('<option value="M-L">M-L</option>');

		            $("#pcolor").append('<option value="请选择">请选择</option>');
		            $("#pcolor").append('<option value="黑色">黑色</option>');
		            $("#pcolor").append('<option value="肤色">肤色</option>');
                }

            }

        </script>
    </form>
</body>
</html>
